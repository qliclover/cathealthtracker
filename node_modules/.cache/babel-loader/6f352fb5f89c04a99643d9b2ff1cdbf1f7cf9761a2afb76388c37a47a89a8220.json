{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Routes,Route,Navigate,useNavigate}from'react-router-dom';import Navbar from'./components/Navbar';import LoginPage from'./LoginPage';import RegisterPage from'./RegisterPage';import CatListPage from'./CatListPage';import CatDetailsPage from'./CatDetailsPage';import AddCatPage from'./AddCatPage';import EditCatPage from'./EditCatPage';import AddRecordPage from'./AddRecordPage';import EditRecordPage from'./EditRecordPage';// 保护路由组件\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children}=_ref;const token=localStorage.getItem('token');if(!token){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}return children;};function App(){const[isReady,setIsReady]=useState(false);const navigate=useNavigate();useEffect(()=>{// 简单检查token是否存在\nconst token=localStorage.getItem('token');// 如果用户没有登录且不在登录/注册页面，重定向到登录页面\nif(!token){const path=window.location.pathname;if(path!=='/login'&&path!=='/register'){navigate('/login');}}setIsReady(true);},[navigate]);if(!isReady){return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center align-items-center\",style:{height:'100vh'},children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-primary\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"\\u52A0\\u8F7D\\u4E2D...\"})})});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"container mt-4\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(LoginPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(RegisterPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/cats\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(CatListPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/cats/:id\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(CatDetailsPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/cats/add\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(AddCatPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/cats/:id/edit\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(EditCatPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/cats/:id/records/add\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(AddRecordPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/records/:id/edit\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(EditRecordPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/cats\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-warning text-center mt-5\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u9875\\u9762\\u4E0D\\u5B58\\u5728\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u60A8\\u8BBF\\u95EE\\u7684\\u9875\\u9762\\u4E0D\\u5B58\\u5728\\u6216\\u5DF2\\u88AB\\u79FB\\u9664\\u3002\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>navigate('/'),children:\"\\u8FD4\\u56DE\\u9996\\u9875\"})]})})]})})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","Routes","Route","Navigate","useNavigate","Navbar","LoginPage","RegisterPage","CatListPage","CatDetailsPage","AddCatPage","EditCatPage","AddRecordPage","EditRecordPage","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","children","token","localStorage","getItem","to","replace","App","isReady","setIsReady","navigate","path","window","location","pathname","className","style","height","role","element","onClick"],"sources":["/Users/qianli/cathealthtracker-full/cathealty/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Routes, Route, Navigate, useNavigate } from 'react-router-dom';\nimport Navbar from './components/Navbar';\nimport LoginPage from './LoginPage';\nimport RegisterPage from './RegisterPage';\nimport CatListPage from './CatListPage';\nimport CatDetailsPage from './CatDetailsPage';\nimport AddCatPage from './AddCatPage';\nimport EditCatPage from './EditCatPage';\nimport AddRecordPage from './AddRecordPage';\nimport EditRecordPage from './EditRecordPage';\n\n// 保护路由组件\nconst ProtectedRoute = ({ children }) => {\n  const token = localStorage.getItem('token');\n  if (!token) {\n    return <Navigate to=\"/login\" replace />;\n  }\n  return children;\n};\n\nfunction App() {\n  const [isReady, setIsReady] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    // 简单检查token是否存在\n    const token = localStorage.getItem('token');\n    \n    // 如果用户没有登录且不在登录/注册页面，重定向到登录页面\n    if (!token) {\n      const path = window.location.pathname;\n      if (path !== '/login' && path !== '/register') {\n        navigate('/login');\n      }\n    }\n    \n    setIsReady(true);\n  }, [navigate]);\n\n  if (!isReady) {\n    return (\n      <div className=\"d-flex justify-content-center align-items-center\" style={{ height: '100vh' }}>\n        <div className=\"spinner-border text-primary\" role=\"status\">\n          <span className=\"visually-hidden\">加载中...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <Navbar />\n      <div className=\"container mt-4\">\n        <Routes>\n          {/* 公开路由 */}\n          <Route path=\"/login\" element={<LoginPage />} />\n          <Route path=\"/register\" element={<RegisterPage />} />\n          \n          {/* 受保护路由 */}\n          <Route path=\"/cats\" element={\n            <ProtectedRoute>\n              <CatListPage />\n            </ProtectedRoute>\n          } />\n          \n          <Route path=\"/cats/:id\" element={\n            <ProtectedRoute>\n              <CatDetailsPage />\n            </ProtectedRoute>\n          } />\n          \n          <Route path=\"/cats/add\" element={\n            <ProtectedRoute>\n              <AddCatPage />\n            </ProtectedRoute>\n          } />\n          \n          <Route path=\"/cats/:id/edit\" element={\n            <ProtectedRoute>\n              <EditCatPage />\n            </ProtectedRoute>\n          } />\n          \n          <Route path=\"/cats/:id/records/add\" element={\n            <ProtectedRoute>\n              <AddRecordPage />\n            </ProtectedRoute>\n          } />\n          \n          <Route path=\"/records/:id/edit\" element={\n            <ProtectedRoute>\n              <EditRecordPage />\n            </ProtectedRoute>\n          } />\n          \n          {/* 默认路由 */}\n          <Route path=\"/\" element={<Navigate to=\"/cats\" replace />} />\n          \n          {/* 404路由 */}\n          <Route path=\"*\" element={\n            <div className=\"alert alert-warning text-center mt-5\">\n              <h3>页面不存在</h3>\n              <p>您访问的页面不存在或已被移除。</p>\n              <button \n                className=\"btn btn-primary\" \n                onClick={() => navigate('/')}\n              >\n                返回首页\n              </button>\n            </div>\n          } />\n        </Routes>\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,MAAM,CAAEC,KAAK,CAAEC,QAAQ,CAAEC,WAAW,KAAQ,kBAAkB,CACvE,MAAO,CAAAC,MAAM,KAAM,qBAAqB,CACxC,MAAO,CAAAC,SAAS,KAAM,aAAa,CACnC,MAAO,CAAAC,YAAY,KAAM,gBAAgB,CACzC,MAAO,CAAAC,WAAW,KAAM,eAAe,CACvC,MAAO,CAAAC,cAAc,KAAM,kBAAkB,CAC7C,MAAO,CAAAC,UAAU,KAAM,cAAc,CACrC,MAAO,CAAAC,WAAW,KAAM,eAAe,CACvC,MAAO,CAAAC,aAAa,KAAM,iBAAiB,CAC3C,MAAO,CAAAC,cAAc,KAAM,kBAAkB,CAE7C;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBACA,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAClC,KAAM,CAAAE,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAI,CAACF,KAAK,CAAE,CACV,mBAAON,IAAA,CAACZ,QAAQ,EAACqB,EAAE,CAAC,QAAQ,CAACC,OAAO,MAAE,CAAC,CACzC,CACA,MAAO,CAAAL,QAAQ,CACjB,CAAC,CAED,QAAS,CAAAM,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAG5B,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAA6B,QAAQ,CAAGzB,WAAW,CAAC,CAAC,CAE9BL,SAAS,CAAC,IAAM,CACd;AACA,KAAM,CAAAsB,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C;AACA,GAAI,CAACF,KAAK,CAAE,CACV,KAAM,CAAAS,IAAI,CAAGC,MAAM,CAACC,QAAQ,CAACC,QAAQ,CACrC,GAAIH,IAAI,GAAK,QAAQ,EAAIA,IAAI,GAAK,WAAW,CAAE,CAC7CD,QAAQ,CAAC,QAAQ,CAAC,CACpB,CACF,CAEAD,UAAU,CAAC,IAAI,CAAC,CAClB,CAAC,CAAE,CAACC,QAAQ,CAAC,CAAC,CAEd,GAAI,CAACF,OAAO,CAAE,CACZ,mBACEZ,IAAA,QAAKmB,SAAS,CAAC,kDAAkD,CAACC,KAAK,CAAE,CAAEC,MAAM,CAAE,OAAQ,CAAE,CAAAhB,QAAA,cAC3FL,IAAA,QAAKmB,SAAS,CAAC,6BAA6B,CAACG,IAAI,CAAC,QAAQ,CAAAjB,QAAA,cACxDL,IAAA,SAAMmB,SAAS,CAAC,iBAAiB,CAAAd,QAAA,CAAC,uBAAM,CAAM,CAAC,CAC5C,CAAC,CACH,CAAC,CAEV,CAEA,mBACEH,KAAA,QAAAG,QAAA,eACEL,IAAA,CAACV,MAAM,GAAE,CAAC,cACVU,IAAA,QAAKmB,SAAS,CAAC,gBAAgB,CAAAd,QAAA,cAC7BH,KAAA,CAAChB,MAAM,EAAAmB,QAAA,eAELL,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,QAAQ,CAACQ,OAAO,cAAEvB,IAAA,CAACT,SAAS,GAAE,CAAE,CAAE,CAAC,cAC/CS,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,WAAW,CAACQ,OAAO,cAAEvB,IAAA,CAACR,YAAY,GAAE,CAAE,CAAE,CAAC,cAGrDQ,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,OAAO,CAACQ,OAAO,cACzBvB,IAAA,CAACG,cAAc,EAAAE,QAAA,cACbL,IAAA,CAACP,WAAW,GAAE,CAAC,CACD,CACjB,CAAE,CAAC,cAEJO,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,WAAW,CAACQ,OAAO,cAC7BvB,IAAA,CAACG,cAAc,EAAAE,QAAA,cACbL,IAAA,CAACN,cAAc,GAAE,CAAC,CACJ,CACjB,CAAE,CAAC,cAEJM,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,WAAW,CAACQ,OAAO,cAC7BvB,IAAA,CAACG,cAAc,EAAAE,QAAA,cACbL,IAAA,CAACL,UAAU,GAAE,CAAC,CACA,CACjB,CAAE,CAAC,cAEJK,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,gBAAgB,CAACQ,OAAO,cAClCvB,IAAA,CAACG,cAAc,EAAAE,QAAA,cACbL,IAAA,CAACJ,WAAW,GAAE,CAAC,CACD,CACjB,CAAE,CAAC,cAEJI,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,uBAAuB,CAACQ,OAAO,cACzCvB,IAAA,CAACG,cAAc,EAAAE,QAAA,cACbL,IAAA,CAACH,aAAa,GAAE,CAAC,CACH,CACjB,CAAE,CAAC,cAEJG,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,mBAAmB,CAACQ,OAAO,cACrCvB,IAAA,CAACG,cAAc,EAAAE,QAAA,cACbL,IAAA,CAACF,cAAc,GAAE,CAAC,CACJ,CACjB,CAAE,CAAC,cAGJE,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,GAAG,CAACQ,OAAO,cAAEvB,IAAA,CAACZ,QAAQ,EAACqB,EAAE,CAAC,OAAO,CAACC,OAAO,MAAE,CAAE,CAAE,CAAC,cAG5DV,IAAA,CAACb,KAAK,EAAC4B,IAAI,CAAC,GAAG,CAACQ,OAAO,cACrBrB,KAAA,QAAKiB,SAAS,CAAC,sCAAsC,CAAAd,QAAA,eACnDL,IAAA,OAAAK,QAAA,CAAI,gCAAK,CAAI,CAAC,cACdL,IAAA,MAAAK,QAAA,CAAG,4FAAe,CAAG,CAAC,cACtBL,IAAA,WACEmB,SAAS,CAAC,iBAAiB,CAC3BK,OAAO,CAAEA,CAAA,GAAMV,QAAQ,CAAC,GAAG,CAAE,CAAAT,QAAA,CAC9B,0BAED,CAAQ,CAAC,EACN,CACN,CAAE,CAAC,EACE,CAAC,CACN,CAAC,EACH,CAAC,CAEV,CAEA,cAAe,CAAAM,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}